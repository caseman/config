# local-relevant zsh aliases and funcs

export GOPATH="$(go env GOPATH)"
export PATH="$HOME/bin:$GOPATH/bin:$PATH"

alias pg="pg_ctl -D /usr/local/var/postgres"
alias pglh="psql -U postgres -h localhost -p 5432"
alias ag="ag --ignore-dir node_modules"
alias f="ag -g"
alias vrc="(cd ~/git/config && v .*rc macos/.localrc macos/*.sh)"

alias notes="(cd ~/notes && mvim --servername NOTES --remote-silent . NUL)"

# Default hub to use cbhq github enterprise 
export GITHUB_HOST="github.cbhq.net"
alias ghpr="gpsup && hub pull-request --browse"

export SCROLLS_PRETTY_PRINT=1

# setup nvm
export NVM_DIR="$HOME/.nvm"
source "/usr/local/opt/nvm/nvm.sh" &!

v() {
    # Group windows by git repo or base directory
    if git rev-parse --is-inside-work-tree NUL; then
        SERVER="$(basename $(git rev-parse --show-toplevel))"
    else
        SERVER="$(basename $(pwd))"
    fi
    if [[ "$#" == "0" ]]; then
        mvim --servername "$SERVER" -c NERDTree --remote-silent .
    else
        mvim --servername "$SERVER" --remote-silent $@ NUL
    fi
}

# Find files by name and open in vim
vf() {
    FILES=$(ag --nocolor -g "$1" -print)
    if [[ "$FILES" != "" ]]; then
        echo "$FILES"
        v "$FILES"
    else
        echo >&2 "No files found"
    fi
}

# Launch vim and grep for easy browsing
vg() {
    vim -u ~/.minimal-vimrc +":so ~/.vim/scripts/grep.vim | :Ag $@"
}
